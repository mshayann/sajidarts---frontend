<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sajid Arts</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="img/favicon.png" />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <script></script>

    <!-- navbar section -->
    <section id="header">
      <a
        href="/index.html"
        class="logo-link"
        style="display: inline-block; text-align: end; text-decoration: none"
        ><img src="img/sajidartslogo.png" class="logo" alt="" /><small
          style="display: block; font-size: 10px; color: #555"
          >Since 1987</small
        ></a
      >

      <div>
        <ul id="navbar">
          <li><a id="homeLink" href="/index.html">Home</a></li>
          <!-- Shop Dropdown -->
          <li class="dropdown">
            <a href="#">Shop ▾</a>
            <ul class="dropdown-menu">
              <li>
                <a href="/wooden-wall-decor.html">Wooden Wall Decor Scenery</a>
              </li>
              <li><a href="/workplace-decor.html">Workplace Decor</a></li>
              <li><a href="/arabic-calligraphy.html">Arabic Calligraphy</a></li>
              <li><a href="/gold-acrylic-decor.html">Gold Acrylic Decor</a></li>
              <li>
                <a href="/chrome-acrylic-decor.html">Chrome Acrylic Decor</a>
              </li>
              <li>
                <a href="/customized-neon-signs.html">Customized Neon Signs</a>
              </li>
              <li>
                <a href="/acrylic-wall-clocks.html">Acrylic Wall Clocks</a>
              </li>
              <li><a href="/acrylic-shields.html">Acrylic Shields</a></li>
              <li>
                <a href="/offset-printing-works.html">Offset Printing Works</a>
              </li>
            </ul>
          </li>

          <li><a id="aboutLink" href="/about.html">About</a></li>
          <li><a id="contactLink" href="/contact.html">Contact</a></li>
          <li id="lg-bag">
            <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
          </li>
          <a href="#" id="close"><i class="fas fa-times"></i></a>
        </ul>
      </div>
      <div id="mobile">
        <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
        <i id="bar" class="fas fa-outdent"></i>
      </div>
    </section>

    <section id="cart" class="section-p1">
      <h2 style="text-align: center; margin-bottom: 20px;">Your Cart</h2>
      <table>
        <thead>
          <tr>
            <td>Remove</td>
            <td>Image</td>
            <td>Product</td>
            <td>Price</td>
            <td>Quantity</td>
            <td>Subtotal</td>
          </tr>
        </thead>
        
        <tbody id="cart-items"></tbody>
      </table>
    </section>

    <section id="cart-add" class="section-p1">
      <div id="subtotal">
        <h3>Cart Total</h3>
        <table>
          <tr>
            <td>Cart Subtotal</td>
            
          </tr>
          <tr>
            <td>Delivery</td>
          </tr>
          <tr>
            <td><strong>Total</strong></td>
          </tr>
        </table>
        <div style="display: flex; justify-content: flex-end">
          <button id="openModalBtn" class="normal">
            Place Order
            <i style="padding-left: 5px" class="fa-solid fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- footer section -->
    <footer class="section-p1">
      <div class="col">
        <img class="logo" src="img/sajidartslogo.png" alt="" />
        <h4>Contact</h4>
        <p>
          <strong>Address: </strong>Shop No. 3, BS 12/1, Opp. Bank Al Habib,
          F.B. Area, Karimabad, Karachi
        </p>
        <p><strong>Phone:</strong> +92 317 7693301</p>
        <p><strong>Hours:</strong> 10:00 - 21:00, Mon - Sat</p>
        <div class="follow">
          <h4>Follow Us</h4>
          <div class="icon">
            <i class="fab fa-facebook-f"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-instagram"></i>
            <i class="fab fa-youtube"></i>
          </div>
        </div>
      </div>
      <div class="col">
        <h4>About</h4>
        <a href="/about.html">About Us</a>
        <a href="#">Policies</a>
        <a href="/contact.html">Contact Us</a>
      </div>
      <div class="col">
        <h4>My Account</h4>
        <a href="/cart.html">View Cart</a>
      </div>
      <div class="copyright">
        <p>© 2025, Sajid Arts</p>
      </div>
    </footer>
    <!-- Modal -->
    <div id="orderModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Enter Your Details</h3>
        <form id="modalOrderForm">
          <label>Full Name*</label>
          <input
            type="text"
            id="modalFullName"
            placeholder="Enter Full Name"
            required
          />

          <label>Email</label>
          <input
            type="email"
            id="modalEmail"
            placeholder="Enter Email Address(Optional)"
          />

          <label>Contact Number*</label>
          <input
            type="text"
            id="modalContact"
            placeholder="Enter Contact Number"
            required
          />
           <label>City*</label>
          <input
            type="text"
            id="modalCity"
            placeholder="Enter City Name"
            required
          />

          <label>Address*</label>
          <textarea
            id="modalAddress"
            placeholder="Enter Full Address"
            required
          ></textarea>

          <label>Order Details</label>
          <textarea
            id="modalDescription"
            placeholder="Specify size, color, or any other customization you want. (Optional)"
            
          ></textarea>

          <button type="submit" class="normal">Place Order</button>
        </form>
      </div>
    </div>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <script>
      function renderCart() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const tbody = document.getElementById("cart-items");
        tbody.innerHTML = "";

        let total = 0;
        cart.forEach((item) => {
          const subtotal = item.price * item.quantity;
          total += subtotal;


          tbody.innerHTML += `
        <tr>
          <td><a href="#" class="remove" data-id="${item.id}">
            <i class="fa-regular fa-trash-can fa-lg big-trash"></i></a></td>
          <td><img src="${item.image}" alt="${item.name}"></td>
          <td>${item.name}</td>
          <td>Rs. ${item.price}</td>
          <td><input type="number" min="1" value="${item.quantity}" class="qty" data-id="${item.id}"></td>
          <td>Rs. ${subtotal}</td>
        </tr>
      `;
        });

        // update totals
        document.querySelector("#subtotal table").innerHTML = `
      <tr><td>Cart Subtotal</td><td>Rs. ${total}</td></tr>
      <tr><td>Delivery</td><td>Rs. 200</td></tr>
      <tr><td><strong>Total</strong></td><td><strong>Rs. ${total + 200}</strong></td></tr>
    `;

        // remove item
        document.querySelectorAll(".remove").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            e.preventDefault();
            const id = parseInt(btn.dataset.id);
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart = cart.filter((item) => item.id !== id);
            localStorage.setItem("cart", JSON.stringify(cart));
            renderCart();
          });
        });

        // update qty
        document.querySelectorAll(".qty").forEach((input) => {
          input.addEventListener("change", (e) => {
            const id = parseInt(input.dataset.id);
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            const item = cart.find((i) => i.id === id);
            if (item) {
              item.quantity = parseInt(input.value) || 1;
              localStorage.setItem("cart", JSON.stringify(cart));
              renderCart();
            }
          });
        });
      }

      document.addEventListener("DOMContentLoaded", renderCart);
    </script>

    <script>
      // Modal functionality
      const modal = document.getElementById("orderModal");
      const openModalBtn = document.getElementById("openModalBtn"); // <-- fixed
      const closeModalBtn = document.querySelector(".modal .close");
      const modalForm = document.getElementById("modalOrderForm");

      openModalBtn.addEventListener("click", () => {
        modal.style.display = "block";
      });

      closeModalBtn.addEventListener("click", () => {
        modal.style.display = "none";
      });

      window.addEventListener("click", (e) => {
        if (e.target == modal) modal.style.display = "none";
      });

      // EmailJS integration
      emailjs.init("_wN7K_GXJAEFhb1B3"); // replace with your EmailJS user ID

modalForm.addEventListener("submit", (e) => {
  e.preventDefault();

  // Collect customer details
  const fullName = document.getElementById("modalFullName").value;
  const email = document.getElementById("modalEmail").value;
  const contact = document.getElementById("modalContact").value;
  const city = document.getElementById("modalCity").value;
  const address = document.getElementById("modalAddress").value;
  const description = document.getElementById("modalDescription").value;

  // Collect cart products
  const cart = JSON.parse(localStorage.getItem("cart")) || [];

  // Convert cart into array for EmailJS template
  const orders = cart.map((item) => ({
    name: item.name,
    units: item.quantity,
    price: item.price * item.quantity,
    image_url: item.image || "https://via.placeholder.com/64" // fallback
  }));

    // ✅ Check if cart is empty
  if (orders.length === 0) {
    alert("Your cart is empty. Please add products before placing an order.");
    return;
  }

  // Calculate totals
  const total = orders.reduce((sum, item) => sum + item.price, 0);

  // Prepare email data
  const emailData = {
    order_id: Date.now(), // simple unique ID
    customer_name: fullName,
    customer_email: email,
    customer_contact: contact,
    customer_city: city,
    customer_address: address,
    product_description: description,
    orders: orders, // array for template loop
    cost: {
      shipping: 200,
      tax: 0,
      total: total+200,
    },
    // website_url: "https://sajidart.com" // optional branding
  };

  // Send email via EmailJS
  emailjs
    .send("service_c9x7sqi", "template_sxv1hyp", emailData)
    .then(() => {
      alert("Order sent successfully!");
      modalForm.reset();
      modal.style.display = "none";
      localStorage.removeItem("cart"); // optional: clear cart
      renderCart(); // refresh cart table
    })
    .catch((err) => {
      alert("Failed to send order. Please try again.");
      console.error(err);
    });
});



      </script>
  </body>
</html>
